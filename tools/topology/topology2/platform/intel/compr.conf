
IncludeByKey.COMPRESSED_1 {
"true"	{
	Object.Pipeline.compr-playback [
		{
			index $COMPR_PIPELINE_ID

			Object.Widget.host-copier.1 {
				stream_name $COMPR_PCM_NAME
				pcm_id $COMPR_PCM_ID

				num_input_audio_formats 20
				CombineArrays.Object.Base.input_audio_format [
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 8 ]
						in_valid_bit_depth [ 8 ]
						in_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 16 ]
						in_valid_bit_depth [ 16 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 24 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 32 ]
					}
				]

				num_output_audio_formats 20
				CombineArrays.Object.Base.output_audio_format [
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 8 ]
						out_valid_bit_depth [ 8 ]
						out_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 16 ]
						out_valid_bit_depth [ 16 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 24 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 32 ]
					}
				]
			}

			Object.Widget.decoder.1 {
				core_id 1

				num_input_audio_formats 20
				CombineArrays.Object.Base.input_audio_format [
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 8 ]
						in_valid_bit_depth [ 8 ]
						in_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 16 ]
						in_valid_bit_depth [ 16 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 24 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 32 ]
					}
				]

				num_output_audio_formats 20
				CombineArrays.Object.Base.output_audio_format [
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 8 ]
						out_valid_bit_depth [ 8 ]
						out_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 16 ]
						out_valid_bit_depth [ 16 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 24 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 32 ]
					}
				]
			}

			# converts the input to S32_LE
			Object.Widget.module-copier.2 {
				num_input_audio_formats 20
				CombineArrays.Object.Base.input_audio_format [
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 8 ]
						in_valid_bit_depth [ 8 ]
						in_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 16 ]
						in_valid_bit_depth [ 16 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 24 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 32 ]
					}
				]

				num_output_audio_formats 5
				CombineArrays.Object.Base.output_audio_format [
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 32 ]
					}
				]
			}

			# converts the input to 48KHz
			# note: this is wrong for 96/192KHz HiRes audio!!!!
			Object.Widget.src.1 {
				rate_out 48000

				<include/components/src_format_s32_convert_to_48k.conf>
			}

			Object.Widget.gain.1 {
				Object.Control.mixer.1 {
					name 'Pre Mixer $COMPR_PCM_NAME Volume'
				}
				num_input_audio_formats 1
				Object.Base.input_audio_format [
					{
						in_rate			48000
						in_bit_depth		32
						in_valid_bit_depth	32
					}
				]
				num_output_audio_formats 1
				Object.Base.output_audio_format [
					{
						out_rate		48000
						out_bit_depth		32
						out_valid_bit_depth	32
					}
				]
			}
			Object.Widget.mixin.1 {
				Object.Base.input_audio_format [
					{
						in_rate			48000
						in_bit_depth            32
						in_valid_bit_depth      32
					}
				]
				Object.Base.output_audio_format [
					{
						out_rate		48000
						out_bit_depth		32
						out_valid_bit_depth	32
					}
				]
			}
		}
	]

	Object.PCM.pcm [
		{
			name $COMPR_PCM_NAME
			id $COMPR_PCM_ID
			direction playback
			compress "true"

			Object.Base.fe_dai.1 {
				name "$COMPR_PCM_NAME"
			}

			Object.PCM.pcm_caps.1 {
				name $COMPR_PCM_NAME
				formats 'S32_LE'
				rates '8000'
			}
		}
	]

	Object.Base.route [
		{
			source  $COMPR_PIPELINE_SRC
			sink	$COMPR_PIPELINE_SINK
		}
		{
			source  host-copier.$COMPR_PCM_ID.playback
			sink	decoder.$COMPR_PIPELINE_ID.1
		}
	]
}
}

# Spawn another instance for speaker
IncludeByKey.COMPRESSED_2 {
"true"	{
	Object.Pipeline.compr-playback [
		{
			index $COMPR_2_PIPELINE_ID

			Object.Widget.host-copier.1 {
				stream_name $COMPR_2_PCM_NAME
				pcm_id $COMPR_2_PCM_ID

				num_input_audio_formats 20
				CombineArrays.Object.Base.input_audio_format [
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 8 ]
						in_valid_bit_depth [ 8 ]
						in_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 16 ]
						in_valid_bit_depth [ 16 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 24 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 32 ]
					}
				]

				num_output_audio_formats 20
				CombineArrays.Object.Base.output_audio_format [
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 8 ]
						out_valid_bit_depth [ 8 ]
						out_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 16 ]
						out_valid_bit_depth [ 16 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 24 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 32 ]
					}
				]
			}

			Object.Widget.decoder.1 {
				core_id 1

				num_input_audio_formats 20
				CombineArrays.Object.Base.input_audio_format [
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 8 ]
						in_valid_bit_depth [ 8 ]
						in_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 16 ]
						in_valid_bit_depth [ 16 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 24 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 32 ]
					}
				]

				num_output_audio_formats 20
				CombineArrays.Object.Base.output_audio_format [
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 8 ]
						out_valid_bit_depth [ 8 ]
						out_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 16 ]
						out_valid_bit_depth [ 16 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 24 ]
					}
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
						out_bit_depth [ 32 ]
						out_valid_bit_depth [ 32 ]
					}
				]
			}

			# converts the input to S32_LE
			Object.Widget.module-copier.2 {
				num_input_audio_formats 20
				CombineArrays.Object.Base.input_audio_format [
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 8 ]
						in_valid_bit_depth [ 8 ]
						in_sample_type [ $SAMPLE_TYPE_UNSIGNED_INTEGER ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 16 ]
						in_valid_bit_depth [ 16 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 24 ]
					}
					{
						in_rate [
							8000
							44100
							48000
							96000
							192000
						]
						in_bit_depth [ 32 ]
						in_valid_bit_depth [ 32 ]
					}
				]

				num_output_audio_formats 5
				CombineArrays.Object.Base.output_audio_format [
					{
						out_rate [
							8000
							44100
							48000
							96000
							192000
						]
					out_bit_depth [ 32 ]
					out_valid_bit_depth [ 32 ]
					}
				]
			}

			# converts the input to 48KHz
			# note: this is wrong for 96/192KHz HiRes audio!!!!
			Object.Widget.src.1 {
				rate_out 48000

				<include/components/src_format_s32_convert_to_48k.conf>
			}

			Object.Widget.gain.1 {
				Object.Control.mixer.1 {
					name 'Pre Mixer $COMPR_2_PCM_NAME Volume'
				}
				num_input_audio_formats 1
				Object.Base.input_audio_format [
					{
						in_rate			48000
						in_bit_depth		32
						in_valid_bit_depth	32
					}
				]
				num_output_audio_formats 1
				Object.Base.output_audio_format [
					{
						out_rate		48000
						out_bit_depth		32
						out_valid_bit_depth	32
					}
				]
			}
			Object.Widget.mixin.1 {
				Object.Base.input_audio_format [
					{
						in_rate			48000
						in_bit_depth            32
						in_valid_bit_depth      32
					}
				]
				Object.Base.output_audio_format [
					{
						out_rate		48000
						out_bit_depth		32
						out_valid_bit_depth	32
					}
				]
			}
		}
	]

	Object.PCM.pcm [
		{
			name $COMPR_2_PCM_NAME
			id $COMPR_2_PCM_ID
			direction playback
			compress "true"

			Object.Base.fe_dai.1 {
				name "$COMPR_2_PCM_NAME"
			}

			Object.PCM.pcm_caps.1 {
				name $COMPR_2_PCM_NAME
				formats 'S32_LE'
				rates '8000'
			}
		}
	]

	Object.Base.route [
		{
			source  $COMPR_2_PIPELINE_SRC
			sink	$COMPR_2_PIPELINE_SINK
		}
		{
			source  host-copier.$COMPR_2_PCM_ID.playback
			sink	decoder.$COMPR_2_PIPELINE_ID.1
		}
	]
}
}
