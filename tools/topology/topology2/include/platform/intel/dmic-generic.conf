<include/dais/dmic.conf>
<include/dais/pdm_config.conf>
<include/components/@DMIC0_EQIIR_COEF@.conf>
<include/components/@DMIC1_EQIIR_COEF@.conf>
Object.Dai {
	DMIC.0 {
		name dmic01
		id @DMIC0_ID@
		default_hw_conf_id @DMIC0_ID@
		unmute_ramp_time_ms 200
		# PDM config will be included based on channel input
		@PDM_CONFIG@
		Object.Base.hw_config.DMIC0 [
		]
		Object.Widget.dai.0 {
			stream_name dmic01
			index @DMIC0_PIPELINE_ID@
			type dai_out
			period_sink_count 2
			period_source_count 0
			format s32le
		}
	}
	DMIC.1 {
		name dmic16k
		id @DMIC1_ID@
		default_hw_conf_id @DMIC1_ID@
		sample_rate 16000
		# PDM config will be included based on channel input
		@PDM_CONFIG@
		Object.Base.hw_config.DMIC1 [
		]
		Object.Widget.dai.0 {
			stream_name dmic16k
			index @DMIC1_PIPELINE_ID@
			type dai_out
			period_sink_count 2
			period_source_count 0
			format s32le
		}
	}
}
Object.Pipeline {
	eq-iir-volume-capture."@DMIC0_PIPELINE_ID@" {
		dynamic_pipeline	@DYNAMIC_PIPELINE@
		Object.Widget.pipeline.1 {
			stream_name 'dai.DMIC.0.capture'
		}
		Object.Widget.host.capture {
			stream_name 'Highpass Capture @DMIC_PCM_ID@'
		}
		Object.Widget.pga.1 {
			Object.Control.mixer.1 {
				name 'Capture Volume'
				access [
					'read_write'
					'tlv_read'
				]
				max 70
			}
			Object.Control.mixer.2 {
				mute_led_use	1
				mute_led_direction 1
				name 'Capture Switch'
				access.0 'read_write'
			}
		}
		Object.Widget.eqiir.1 {
			Object.Control.bytes.1 {
				name eqiir_bytes_@DMIC0_PIPELINE_ID@
				Object.Base.data.@DMIC0_EQIIR_COEF@ {}
			}
		}
		format s32le
		channels	@CHANNELS@
	}
	eq-iir-volume-capture."@DMIC1_PIPELINE_ID@" {
		Object.Widget.pipeline.1 {
			stream_name 'dai.DMIC.1.capture'
		}
		Object.Widget.host.capture {
			stream_name 'Highpass Capture @DMIC16KHz_PCM_ID@'
		}
		Object.Widget.pga.1 {
			Object.Control.mixer.1 {
				name '2nd Capture Volume'
				access [
					'read_write'
					'tlv_read'
				]
				max 70
			}
		}
		Object.Widget.eqiir.1 {
			Object.Control.bytes.1 {
				name eqiir_bytes_@DMIC1_PIPELINE_ID@
				Object.Base.data.@DMIC1_EQIIR_COEF@ {}
			}
		}
		dynamic_pipeline	@DYNAMIC_PIPELINE@
		rate 16000
		format s32le
		channels	@CHANNELS@
	}
}
Object.PCM {
	pcm."@DMIC_PCM_ID@" {
		name DMIC
		Object.Base.fe_dai.DMIC [
		]
		Object.PCM.pcm_caps.capture {
			name 'Highpass Capture @DMIC_PCM_ID@'
			channels_min	@CHANNELS@
			channels_max	@CHANNELS@
		}
		direction capture
	}
	pcm."@DMIC16KHz_PCM_ID@" {
		name DMIC16kHz
		Object.Base.fe_dai.DMIC16kHz [
		]
		Object.PCM.pcm_caps.capture {
			name 'Highpass Capture @DMIC16KHz_PCM_ID@'
			rate_min 16000
			rate_max 16000
			channels_min	@CHANNELS@
			channels_max	@CHANNELS@
		}
		direction capture
	}
}

# routes starting with ID 100 to avoid being overridden when included in the top-level topology
Object.Base {
	route."100" {
		sink 'buffer.@DMIC0_PIPELINE_ID@.3'
		source 'dai.DMIC.0.capture'
	}
	route. "101" {
		sink 'buffer.@DMIC1_PIPELINE_ID@.3'
		source 'dai.DMIC.1.capture'
	}
}
